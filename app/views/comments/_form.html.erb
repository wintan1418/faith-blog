<%= form_with model: [post, comment], id: "comment_form", class: "flex items-start gap-3" do |f| %>
  <% if current_user.profile.avatar.attached? %>
    <%= image_tag current_user.profile.avatar, class: "w-10 h-10 avatar rounded-full object-cover flex-shrink-0" %>
  <% else %>
    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center text-white font-medium flex-shrink-0">
      <%= current_user.username[0].upcase %>
    </div>
  <% end %>
  
  <div class="flex-1" data-controller="emoji-picker">
    <div class="relative">
      <%= f.text_area :content, 
          class: "input resize-none pr-10", 
          rows: 3, 
          placeholder: "Share your thoughts, encouragement, or prayers...",
          data: { emoji_picker_target: "editor" } %>
      
      <!-- Emoji Picker Button -->
      <button type="button" 
              data-emoji-picker-target="button"
              data-action="click->emoji-picker#toggle"
              class="absolute right-2 top-2 p-1.5 text-gray-400 hover:text-amber-600 dark:hover:text-amber-400 hover:bg-amber-50 dark:hover:bg-amber-900/20 rounded transition-colors"
              title="Add emoji">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
      </button>
      
      <!-- Emoji Picker -->
      <div data-emoji-picker-target="picker" 
           class="hidden absolute right-0 bottom-full mb-2 z-50">
        <emoji-picker 
          style="width: 320px; height: 360px;"
          skin-tone-emoji="ðŸ‘"
          class="rounded-lg shadow-xl border border-gray-200 dark:border-gray-700">
        </emoji-picker>
      </div>
    </div>
    
    <div class="flex items-center justify-end gap-2 mt-2">
      <%= f.submit "Post Comment", class: "btn-primary btn-sm" %>
    </div>
  </div>
<% end %>

